# Frontend Integration Guide

This guide explains how the frontend should call Server Actions and REST APIs for HealthFun.

---

## Authentication (NextAuth)

### Sign in
```tsx
import { signIn } from "next-auth/react";

const result = await signIn("credentials", {
  username: "demo_user",
  password: "demo_password",
  redirect: false,
});

if (result?.ok) {
  // redirect to dashboard
}
```

> 注意：不要直接呼叫 `/api/auth/signin`，請使用 NextAuth client API。

### Sign out
```tsx
import { signOut } from "next-auth/react";

await signOut({ redirect: true, callbackUrl: "/login" });
```

---

## Server Actions Usage

### Dashboard
```tsx
import {
  getWaterSetting,
  updateWaterSetting,
  addWaterEntry,
  getWaterEntriesByDate,
  getTasksByDate,
  createTask,
  toggleTaskCompletion,
} from "@/actions/dashboard";
```

**Example with error handling**
```tsx
try {
  const settings = await getWaterSetting();
  console.log(settings);
} catch (error) {
  console.error("Dashboard action failed:", error);
}
```

### Logs
```tsx
import { createLog, getLogsByDate, getDatesWithLogs } from "@/actions/logs";
```

**Example with error handling**
```tsx
try {
  const logs = await getLogsByDate("2026-01-29");
  console.log(logs);
} catch (error) {
  console.error("Log action failed:", error);
}
```

### Members (Admin only)
```tsx
import { getMembers, createMember, updateMember, deleteMember } from "@/actions/members";
```

**Example with error handling**
```tsx
try {
  const members = await getMembers();
  console.log(members);
} catch (error) {
  console.error("Members action failed:", error);
}
```

---

## REST API Usage (Trends)

### Weight Trend
```tsx
type WeightTrendResponse = { data: Array<{ date: string; weight: number }> };

const res = await fetch("/api/trends/weight?range=7d");
if (!res.ok) {
  throw new Error("Failed to fetch weight trend");
}
const data: WeightTrendResponse = await res.json();
```

### Activity Distribution
```tsx
const res = await fetch("/api/trends/activity?range=month");
if (!res.ok) {
  throw new Error("Failed to fetch activity trend");
}
const { data } = await res.json();
```

### Hydration Trend
```tsx
const res = await fetch("/api/trends/hydration?year=2026&startMonth=1&endMonth=3");
if (!res.ok) {
  throw new Error("Failed to fetch hydration trend");
}
const { data } = await res.json();
```
